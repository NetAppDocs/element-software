<!DOCTYPE reference PUBLIC "-//OASIS//DTD DITA Reference//EN" "file:///C:/InfoShare/Web/Author/ASP/DocTypes/dita-oasis/1.2/technicalContent/dtd/reference.dtd">
<reference id="GUID-B4F5FCDC-0101-4ECD-906C-2D67240D7978" xml:lang="en" xmlns:ditaarch="http://dita.oasis-open.org/architecture/2005/">
  <title id="GUID-EA82D1DF-CCBC-4C3B-AB89-ECC1707C992B">AddNodes</title>
  <shortdesc>You can use the <apiname>AddNodes</apiname> method to add one or more new nodes to a cluster. </shortdesc>
  <prolog>
    <metadata>
      <keywords>
        <keyword>addnodes</keyword>
        <keyword>node</keyword>
        <keyword>add</keyword>
        <keyword>adding</keyword>
        <keyword>nodes</keyword>
        <keyword>cluster</keyword>
      </keywords>
    </metadata>
  </prolog>
  <refbody>
    <section id="GUID-BD7134AC-BA3D-4C73-A55E-E07E5AE863C5">
      <p>When a node that is not configured starts up for the first time, you are prompted to configure the node.  Once you configure the node, it is registered as a "pending node" with the cluster. Storage clusters running  <ph conref="ISH_variables.dita#variables/ELEMENT-SHORT">Element</ph> software automatically image a node to the  version on the cluster. When you add a pending node, the method response includes an asyncHandle value that you can use with the <apiname>GetAsyncResult</apiname> method to query the status of the automatic imaging process.</p>
      <p>The process of adding a  Fibre Channel node is the same as adding Element iSCSI storage nodes to a cluster.  Fibre Channel nodes are registered in the system with a NodeID. When they become accessible, they are put in a "pending node" status. The <apiname>ListAllNodes</apiname>  method will return the pendingNodeID for iSCSI nodes as well as any  Fibre Channel nodes that are available to add to the cluster.</p>
      <p>When you add a node to a cluster that you have configured for virtual networking, the system requires a sufficient number of virtual storage IP addresses to allocate a virtual  IP to the new node. If there are no virtual IP addresses available for the new node, the <apiname>AddNode</apiname> operation fails. Use the <apiname>ModifyVirtualNetwork</apiname> method to add more storage IP addresses to your virtual network.</p>
      <p>Once you add a node, any drives on the node are made available and you can add them using the<apiname> AddDrives</apiname> method to increase the storage capacity of the cluster.</p>
      <note id="GUID-46497A13-530E-4F30-B265-6BED532A937A">It may take several seconds after adding a new node for it to start up and register its drives as available.</note>
    </section>
    <section id="SECTION_5FDA59FBD6494362B4FEAB7754574A08">
      <title id="GUID-7ADFB091-8720-4647-BC9E-B921EA6418D2">Parameter</title>
      <p>This method has the following input parameter:</p>
      <table id="TABLE_8CFB1A7A8CAB40789B59BEAEC1A46AB2">
        <tgroup cols="5">
          <colspec colnum="1" colname="col1" colwidth="1.75*" />
          <colspec colnum="2" colname="col2" colwidth="2*" />
          <colspec colnum="3" colname="col3" colwidth="1.00*" />
          <colspec colnum="4" colname="col4" colwidth="1.27*" />
          <colspec colname="col5" colnum="5" colwidth="1.16*" />
          <thead>
            <row>
              <entry colname="col1">Name</entry>
              <entry colname="col2">Description</entry>
              <entry colname="col3">Type</entry>
              <entry colname="col4">Default value </entry>
              <entry colname="col5">Required </entry>
            </row>
          </thead>
          <tbody>
            <row>
              <entry colname="col1">
                <parmname>autoInstall</parmname>
              </entry>
              <entry colname="col2">If true, a return to factory image (RTFI) will be performed on the node upon adding. The default behavior is to perform RTFI. If the <codeph>cEnableAutoInstall</codeph> cluster constant is false, it takes priority over this parameter. If an upgrade is in progress, the RTFI process will not happen regardless of the value for this parameter.</entry>
              <entry colname="col3">boolean</entry>
              <entry colname="col4">None</entry>
              <entry colname="col5">No</entry>
            </row>
            <row>
              <entry colname="col1">
                <parmname>pendingNodes</parmname>
              </entry>
              <entry colname="col2">Pending NodeIDs for the nodes to be added. You can list all pending nodes using the <apiname>ListPendingNodes</apiname> method.</entry>
              <entry colname="col3">integer array</entry>
              <entry colname="col4">None</entry>
              <entry colname="col5">Yes</entry>
            </row>
          </tbody>
        </tgroup>
      </table>
    </section>
    <section id="SECTION_57AB0E5059EF41C2ABD5AC9AB7F1A2F2">
      <title id="GUID-D537362C-01B9-48AD-9193-607AB2FB4349">Return value</title>
      <p>This method has the following return value:</p>
      <table id="TABLE_B967117CB10C4B22A7CE525A65D5C9E3">
        <tgroup cols="3">
          <colspec colnum="1" colname="col1" colwidth="1.00*" />
          <colspec colnum="2" colname="col2" colwidth="2.50*" />
          <colspec colnum="3" colname="col3" colwidth="1.75*" />
          <thead>
            <row>
              <entry colname="col1">Name</entry>
              <entry colname="col2">Description</entry>
              <entry colname="col3">Type</entry>
            </row>
          </thead>
          <tbody>
            <row>
              <entry colname="col1">autoInstall</entry>
              <entry colname="col2">Whether or not the added nodes are being returned to the factory image.</entry>
              <entry colname="col3">boolean</entry>
            </row>
            <row>
              <entry colname="col1">nodes</entry>
              <entry colname="col2">An array of objects mapping the previous "pendingNodeID" to the "nodeID". When you add a pending node that is running an incompatible software version, this array includes an asyncHandle value that you can use with the <apiname>GetAsyncResult</apiname> method to query the status of the automatic imaging process.</entry>
              <entry colname="col3">JSON object array</entry>
            </row>
          </tbody>
        </tgroup>
      </table>
    </section>
    <section id="SECTION_5FA684D774104B22989CD3F451C07008">
      <title id="GUID-E7471790-2316-4CCD-A290-0A13743927C8">Request example</title>
      <p>Requests for this method are similar to the following example: </p>
      <codeblock xml:space="preserve">{
   "method": "AddNodes",
   "params": {
     "autoInstall" : true,
     "pendingNodes" : [1]
   },
   "id":1
}</codeblock>
    </section>
    <section id="SECTION_BD5D8DCA54094AAE99A91526F00198BA">
      <title id="GUID-A6B1D1CD-41DE-43CF-AFB9-F0D31155763E">Response example</title>
      <p>This method returns a response similar to the following example: </p>
      <codeblock xml:space="preserve">{
  id: null,
  result: {
    autoInstall: true,
    nodes: [
      {
        activeNodeKey: "giAm2ep1hA",
        assignedNodeID: 6,
        asyncHandle: 3,
        cip: "10.10.5.106",
        mip: "192.168.133.106",
        pendingNodeID: 2,
        platformInfo: {
          chassisType: "R620",
          cpuModel: "Intel(R) Xeon(R) CPU E5-2640 0 @ 2.50GHz",
          nodeMemoryGB: 72,
          nodeType: "SF3010"
        },
        sip: "10.10.5.106",
        softwareVersion: "9.0.0.1077"
      }
    ]
  }
}
</codeblock>
    </section>
    <section id="GUID-14873014-ED37-4999-BADE-47A47FA119C5">
      <title id="GUID-FCD1DB4D-E5CC-46B2-B873-17A3CD16BE2F">New since version</title>
      <p>9.6</p>
    </section>
  </refbody>
</reference>